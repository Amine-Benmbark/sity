{% extends 'base.html.twig' %}

{% block title %}Mon profil{% endblock %}

{% block body %}
  {% block header %}{% endblock %}

<style>
  .custom-img-size {
    width: 150px;
    height: auto;
  }
</style>

  <div class="container mt-5">

    <h2 class="text-center mb-4">Mon profil</h2>

    <div class="table-responsive">
      <table class="table table-striped">
        <thead>
          <tr>
            <th scope="col">Nom</th>
            <th scope="col">Prenom</th>
            <th scope="col">Email</th>
            <th scope="col">Tel</th>
            <th scope="col">Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>{{ app.user.name }}</td>
            <td>{{ app.user.firstname }}</td>
            <td>{{ app.user.email }}</td>
            <td>{{ app.user.tel }}</td>
            <td>
              <div class="btn-group">
                <a href="{{ path('users_profil_modifier') }}" class="btn btn-order">
                  <i class="fas fa-pencil-alt"></i> <span class="d-none d-sm-inline">Modifier</span>
                </a>
                <a onClick="return confirm('Voulez-vous vraiment supprimer votre profil ?')" href="{{ path('users_profil_delete', {'id': app.user.id}) }}" class="btn btn-order">
                  <i class="fas fa-trash-alt"></i> <span class="d-none d-sm-inline">Supprimer</span>
                </a>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

<h2 class="mt-5 mb-5 text-center">Votre panier</h2>
<div class="table-responsive">
  <table class="table">
    <thead>
      <tr>
        <th>Produit</th>
        <th>Image</th>
        <th>Prix</th>
        <th>Quantité</th>
        <th class="text-end">Total</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      {% if articles is not empty %}
        {% for article in articles %}
          <tr>
            <td>{{ article.produit.name }}</td>
            <td><img class="img-fluid custom-img-size" alt="image du produit" src="{{ asset('assets/img/' ~ article.produit.img) }}"></td>
            <td>{{ article.produit.prix }}€</td>
            <td>{{ article.quantity }}</td>
            <td class="text-end">{{ article.quantity * article.produit.prix }}€</td>
            <td>
              <div class="btn-group">
                <a href="{{ path("app_add_panier", {id: article.produit.id}) }}" class="btn btn-order">
                  <i class="fas fa-check-circle"></i> <span class="d-none d-sm-inline">Ajouter</span>
                </a>
                <a href="{{ path("app_remove_panier", {id: article.produit.id}) }}" class="btn btn-order">
                  <i class="fas fa-pencil-alt"></i> <span class="d-none d-sm-inline">Modifier</span>
                </a>
                <a onClick="return confirm('Voulez-vous vraiment supprimer cet article du panier ?')" href="{{ path("app_delete_panier", {id: article.produit.id}) }}" class="btn btn-order">
                  <i class="fas fa-trash-alt"></i> <span class="d-none d-sm-inline">Supprimer</span>
                </a>
              </div>
            </td>
          </tr>
        {% endfor %}
      {% else %}
        <tr>
          <td colspan="6" class="text-center">
            Votre panier est vide!
          </td>
        </tr>
      {% endif %}
    </tbody>
  </table>
</div>

<h2 class="mt-5 mb-5 text-center">Mes commandes</h2>
<div class="table-responsive">
  <table class="table">
    <thead>
      <tr>
        <th>Produit</th>
        <th>Image</th>
        <th>Prix</th>
        <th>Quantité</th>
        <th>Total</th>
      </tr>
    </thead>
    <tbody>
      {% if commande and detailcommande %}
        {% for commandes in commande %}
          <tr>
            <th colspan="4">Commande N°{{ commandes.id }}</th>
            <th colspan="4"><strong>Date de la commande : {{ commandes.date|date("d-m-Y") }}</strong></th>
          </tr>
          <tr>
            <th>Produit</th>
            <th>Image</th>
            <th>Prix</th>
            <th>Quantité</th>
            <th>Total</th>
          </tr>
          {% for detailcommandes in detailcommande %}
            {% for detail in detailcommandes %}
              {% if commandes.id == detail.commande.id %}
                <tr>
                  <td>{{ detail.name }}</td>
                  <td>
                    <img class="img-fluid custom-img-size" src="{{ asset('assets/img/' ~ detail.img) }}" alt="Product Image">
                  </td>
                  <td>{{ detail.prix }}€</td>
                  <td>{{ detail.quantity }}</td>
                  <td>{{ detail.total }}€</td>
                </tr>
              {% endif %}
            {% endfor %}
          {% endfor %}
        {% endfor %}
      {% else %}
        <tr>
          <td colspan="5" class="text-center">
            Aucune commande effectuée !
          </td>
        </tr>
      {% endif %}
    </tbody>
  </table>
</div>


{% endblock %}

{% block javascripts %}
{% endblock %}
